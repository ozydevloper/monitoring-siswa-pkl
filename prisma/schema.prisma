generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum TypeStatus {
  HADIR
  TIDAK_HADIR
  IZIN
  SAKIT
  ALPHA
}

enum TypeRole {
  GURU
  MURID
}

model Siswa {
  id            String @unique @default(uuid())
  name          String @unique
  password      String
  tempat_pkl_id String
  guru_id       String
  role          String @default("SISWA")

  absensi_hari AbsensiHari[]

  guru_relation       Guru      @relation(fields: [guru_id], references: [id])
  tempat_pkl_relation TempatPKL @relation(fields: [tempat_pkl_id], references: [id])
}

model TempatPKL {
  id         String @unique @default(uuid())
  name       String @unique
  jam_masuk  String
  jam_pulang String

  siswa Siswa[]
}

model AbsensiHari {
  id                String         @unique @default(uuid())
  name              DateTime
  siswa_id          String
  absensi_masuk_id  AbsensiMasuk?
  absensi_pulang_id AbsensiPulang?

  siswa_relation Siswa @relation(fields: [siswa_id], references: [id])
}

model AbsensiMasuk {
  id   String   @unique @default(cuid())
  name DateTime

  status         TypeStatus     @default(HADIR)
  approval       Boolean
  image          String[]
  note           String
  absensi_hari   String         @unique
  approval_inbox ApprovalInbox? @relation(fields: [approvalInboxId], references: [id])

  absensi_hari_relation AbsensiHari @relation(fields: [absensi_hari], references: [id])
  approvalInboxId       String?
}

model AbsensiPulang {
  id   String   @unique @default(cuid())
  name DateTime

  status                  TypeStatus    @default(HADIR)
  approval                Boolean       @default(false)
  image                   String[]
  note                    String
  absensi_hari            String        @unique
  approval_inbox_relation ApprovalInbox @relation(fields: [approval_inbox_id], references: [id])

  absensi_hari_relation AbsensiHari @relation(fields: [absensi_hari], references: [id])

  approval_inbox_id String
}

model Guru {
  id       String  @unique @default(uuid())
  name     String  @unique
  role     String  @default("GURU")
  password String
  siswa    Siswa[]
}

model ApprovalInbox {
  id   String   @unique @default(uuid())
  name DateTime @unique @default(now())

  absensiMasuk  AbsensiMasuk[]
  absensiPulang AbsensiPulang[]
}
